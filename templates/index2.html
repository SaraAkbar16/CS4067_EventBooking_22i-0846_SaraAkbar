<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Registration</title>
    <link rel="stylesheet" href="/static/style2.css">
</head>
<body>
    <h1>Event Registration</h1>

    <!-- Event Registration Form -->
    <form id="eventForm" action="/submit/" method="POST">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" required><br>

        <label for="payment">Payment:</label>
        <input type="number" id="payment" name="payment" min="1000" step="500" required><br>

        <label for="event">Event:</label>
        <input type="number" id="event" name="event" placeholder="Enter event ID" required><br>
        <p>Event ID: {{ event_ids }}</p>
        <button type="submit">Submit</button>
    </form>

    <!-- JavaScript to handle form submission and prevent page refresh -->
    <script>
      document.getElementById("eventForm").addEventListener("submit", function(event) {
    event.preventDefault();  // Prevent form refresh

    // Collect form data into an object
    let formData = {
        name: document.getElementById("name").value,
        payment: document.getElementById("payment").value,
        event: document.getElementById("event").value
    };

    // Send the data to the backend as JSON
    fetch("/submit_form/", {
    method: "POST",
    headers: {
        "Content-Type": "application/json"  // Set content type as JSON
    },
    body: JSON.stringify(formData)  // Convert object to JSON clstring
})
.then(response => response.json())  // Convert the response to JSON
.then(data => {
    if (data.success) {
        // Success response handling
        alert("üéâ Booking saved successfully!\n" + 
              "Name: " + data.data.name + "\n" + 
              "Payment: " + data.data.payment + "\n" + 
              "Event ID: " + data.data.event);
        document.getElementById("eventForm").reset();  // Reset the form
    } else {
        // Error response handling
        alert("‚ùå Error saving booking: " + data.message);
    }
})
.catch(error => {
    // Catch any error during the fetch operation
    console.error("Error:", error);
    alert("‚ùå Error submitting the form.");
});
});



    </script>
</body>
</html>
